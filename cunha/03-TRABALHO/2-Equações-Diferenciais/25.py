import math

def rk4(f, x0, y0,x_values, n):
    r = []
    h = x_values[0] - x0
    for _ in range(n):
        #realizar as iterações
        if (_>=1):
            h = x_values[_] - x_values[_-1]
        m1 = f(x0, y0)
        m2 = f(x0 + h/2, y0 + (h/2)*m1)
        m3 = f(x0 + h/2, y0 + (h/2)*m2)
        m4 = f(x0 + h, y0 + h *m3)
        yk = y0 + h * (m1+2*m2+2*m3+m4)/6
        #atualizando os valores
        x0 = x_values[_]
        y0 = yk
        #colocando valores na lista
        r.append((x0, y0))
    return r
    
# modificar valores de r e lambd    
def f(p, t):
    r = 0.17075
    lambd = 0.01516
    k = r * lambd
    return k * (1 - t)

# modificar valor de p0    
t0 = 0
p0 = 0.0014
t_values = [0.1926, 0.94286, 1.81401, 2.53746, 2.98847, 3.85665, 4.20807, 4.8544, 5.88675, 6.07175, 7.0136, 7.54699, 8.41703, 8.81655, 9.52128, 10.47963, 11.04396, 11.58721, 12.44334, 12.81491, 13.67859, 14.17367, 15.22557, 15.60782, 16.47805, 17.03605, 17.51015, 18.09734, 18.93662, 19.89908, 20.22631, 20.73695, 21.504, 22.41396, 23.20687, 23.67042, 24.19104, 25.0723, 25.49308, 26.12624, 27.14165, 27.54762, 28.39075, 29.18747, 29.63257, 30.20217, 31.25603, 31.74119, 32.17076, 32.7724, 33.83448, 34.45062, 34.82665, 35.47085, 36.49646, 36.96307, 37.4709, 38.10687, 38.89404, 39.84549, 40.51346, 41.08795, 41.7505, 42.40419, 42.8291, 43.89608, 44.33794, 45.03971, 45.52689, 46.22265, 46.77335, 47.80485, 48.11767, 48.8571, 49.79152, 50.22953, 51.0225, 51.43437, 52.14937, 53.01977, 53.70723, 54.12333, 54.80457, 55.49348, 56.27648, 57.17174, 57.86356, 58.07167, 58.78471, 59.55421, 60.13944, 61.14456, 61.91428, 62.26006, 62.79486, 63.71524, 64.25209, 64.94143, 65.79064, 66.27882, 66.96121, 67.8436, 68.21759, 69.04843, 69.60863, 70.54389, 70.97979, 71.73498, 72.52471, 73.07003, 73.89351, 74.56355, 75.01419, 75.40902, 76.50517, 77.08722, 77.51728, 78.13248, 78.82915, 79.46948, 80.40273, 80.94118, 81.54904, 82.46882, 82.80091, 83.84249, 84.26145, 84.85008, 85.46746, 86.54524, 87.24222, 87.90406, 88.5314, 88.75185, 89.79502, 90.5645, 91.2198, 91.62759, 92.23772, 93.17232, 93.7406, 94.30326, 95.20376, 95.5197, 96.27954, 96.97455, 97.67269, 98.27479, 99.17716, 99.57304]
n = 150

r = rk4(f, t0, p0, t_values, n)

runge = []
for yi in r:
    runge.append(yi[1])
    
# solução exata:
# modificar valores de r, lambd e coef 
def p(t):
    r = 0.17075
    lambd = 0.01516
    k = r * lambd
    # resolver:
    # solve p'(t) = k * (1 - p(t)), p(0) = p0
    # no wolfram, substituindo o valor de p0 dado na questao
    coef = 0.00992 
    return 1 - coef * math.exp(-k*t)
    
for i in range(150):
    print(f"{runge[i]}, {abs(0)},")